{
    "paperId": "18b6608591542741c86023f26b8cec848d7570dc",
    "title": "RecFlex: Enabling Feature Heterogeneity-Aware Optimization for Deep Recommendation Models with Flexible Schedules",
    "year": 2024,
    "venue": "International Conference for High Performance Computing, Networking, Storage and Analysis",
    "authors": [
        "Zaifeng Pan",
        "Zhen Zheng",
        "Feng Zhang",
        "Bing Xie",
        "Ruofan Wu",
        "Shaden Smith",
        "Chuanjie Liu",
        "Olatunji Ruwase",
        "Xiaoyong Du",
        "Yufei Ding"
    ],
    "doi": "10.1109/SC41406.2024.00047",
    "arxivId": null,
    "url": "https://www.semanticscholar.org/paper/18b6608591542741c86023f26b8cec848d7570dc",
    "isOpenAccess": false,
    "openAccessPdf": "",
    "publicationTypes": [
        "Book",
        "JournalArticle",
        "Conference"
    ],
    "s2FieldsOfStudy": [
        {
            "category": "Computer Science",
            "source": "external"
        },
        {
            "category": "Computer Science",
            "source": "s2-fos-model"
        }
    ],
    "abstract": "Industrial recommendation models typically involve numerous feature fields. The embedding computation workloads are heterogeneous across these fields, thus requiring varied optimal code schedules. While existing solutions apply basic fusion optimization for embedding operations, they inefficiently treat all feature fields with identical schedules, leading to suboptimal performance. In this paper, we introduce RecFlex, which generates fused kernels with distinct schedules for different feature fields. RecFlex employs the interference-aware schedule tuner to tune schedules and the heterogeneous schedule fusion compiler to generate fused kernels, addressing two major challenges. To determine optimal schedules of different feature fields within the fused kernel, RecFlex proposes a two-stage interferencesimulated tuning strategy. To handle dynamic workloads that challenge tuning and fusion, RecFlex combines compile-time schedule tuning with runtime kernel thread mapping. RecFlex surpasses state-of-the-art libraries and compilers, achieving average speedups of $2.64 \\times, 20.77 \\times$, and $11.31 \\times$ over TorchRec, HugeCTR, and RECom, respectively. RecFlex is publicly available at https://github.com/PanZaifeng/RecFlex.",
    "citationCount": 1,
    "referenceCount": 73
}