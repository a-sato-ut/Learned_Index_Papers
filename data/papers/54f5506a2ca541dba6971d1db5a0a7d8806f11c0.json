{
    "paperId": "54f5506a2ca541dba6971d1db5a0a7d8806f11c0",
    "title": "Continual Pre-training of MoEs: How robust is your router?",
    "year": 2025,
    "venue": "Trans. Mach. Learn. Res.",
    "authors": [
        "Benjamin Th'erien",
        "Charles-'Etienne Joseph",
        "Zain Sarwar",
        "Ashwinee Panda",
        "Anirban Das",
        "Shi-Xiong Zhang",
        "Stephen Rawls",
        "Sambit Sahu",
        "Eugene Belilovsky",
        "Irina Rish"
    ],
    "doi": "10.48550/arXiv.2503.05029",
    "arxivId": "2503.05029",
    "url": "https://www.semanticscholar.org/paper/54f5506a2ca541dba6971d1db5a0a7d8806f11c0",
    "isOpenAccess": false,
    "openAccessPdf": "",
    "publicationTypes": [
        "JournalArticle"
    ],
    "s2FieldsOfStudy": [
        {
            "category": "Computer Science",
            "source": "external"
        },
        {
            "category": "Computer Science",
            "source": "s2-fos-model"
        }
    ],
    "abstract": "Sparsely-activated Mixture of Experts (MoE) transformers are promising architectures for foundation models. Compared to dense transformers that require the same amount of floating point operations (FLOPs) per forward pass, MoEs benefit from improved sample efficiency at training time and achieve much stronger performance. Many closed-source and open-source frontier language models have thus adopted an MoE architecture. Naturally, practitioners will want to extend the capabilities of these models with large amounts of newly collected data without completely re-training them. Prior work has shown that a simple combination of replay and learning rate re-warming and re-decaying can enable the continual pre-training (CPT) of dense decoder-only transformers with minimal performance degradation compared to full re-training. In the case of decoder-only MoE transformers, however, it is unclear how the routing algorithm will impact continual pre-training performance: 1) do the MoE transformer's routers exacerbate forgetting relative to a dense model?; 2) do the routers maintain a balanced load on previous distributions after CPT?; 3) are the same strategies applied to dense models sufficient to continually pre-train MoE LLMs? In what follows, we conduct a large-scale (>2B parameter switch and DeepSeek MoE LLMs trained for 600B tokens) empirical study across four MoE transformers to answer these questions. Our results establish a surprising robustness to distribution shifts for both Sinkhorn-Balanced and Z-and-Aux-loss-balanced routing algorithms, even in MoEs continually pre-trained without replay. Moreover, we show that MoE LLMs maintain their sample efficiency (relative to a FLOP-matched dense model) during CPT and that they can match the performance of a fully re-trained MoE at a fraction of the cost.",
    "citationCount": 2,
    "referenceCount": 65
}